<div id="ErraiNavigationPage">
  <div class="title"><h1>Errai Navigation</h1>
    <!--<button id="echo" type="button">Echo</button>-->
  </div>
  <div class="page">
    <h2>Introduction</h2>

    <p>Errai Navigation is a system to create multiple bookmarkable web pages within a single web app. It
       offers a declarative way to configure pages and links and provides compile-time link referential safety
       (i.e.
       no broken links). Errai Navigation also provides clean integration with
      <a href="#Errai UI">Errai UI</a> and other view technologies.
    </p>

    <h2>Installation Instructions</h2>

    <h3>Errai Forge Addon</h3>

    <p>To run the code in this section, use the Errai Forge Addon to add the <code>errai-navigation</code> feature
       to your project.
    </p>

    <h3>Manual Installation</h3>

    <p>If you are not using the Errai Forge addon, here are the steps to manually add Errai Navigation to your
    project. Note that if you are using the Errai Tutorial to follow along, you do not need to complete these
    steps.
    </p>

    <h4>Maven Dependencies</h4>

    <p>Add the following dependencies to your pom.xml</p>
		<pre data-language=html class="code-snippet">
      <dependency>
        <groupId>org.jboss.errai</groupId>
        <artifactId>errai-navigation</artifactId>
        <scope>provided</scope>
      </dependency>

		<dependency>
          <groupId>org.jboss.errai</groupId>
          <artifactId>errai-cdi-client</artifactId>
          <scope>provided</scope>
        </dependency>
		</pre>

    <h4>GWT Module Descriptor</h4>

    <p>Once you have Errai UI Navigation on your classpath, ensure your application inherits the GWT module as well.
    Add this line to your application’s *.gwt.xml file:
    </p>
		<pre data-language=html class="code-snippet">
		<inherits name="org.jboss.errai.ui.nav.Navigation"/>
		</pre>
    <p class="tip textblock">TIP: In our example, the GWT module file is located at <code>src/main/java/org/jboss/errai/demo/ErraiDemo.gwt.xml</code>
    </p>

    <h2>Using Errai Navigation</h2>

    <p>Errai Navigation has these main parts: </p>
    <ul>
      <li>The <code>@Page</code> annotation marks any widget as a page.</li>
      <li>The <code>TransitionTo&lt;P&gt;></code>, <code>TransitionAnchor&lt;P&gt;</code>, and <code>TransitionToRole&lt;R&gt;</code>
          classes are injectable types that provide links to other pages.
      </li>
      <li>The <code>Navigation</code> singleton offers control over the navigation system as a whole.</li>
    </ul>
    <p>
      The Navigation singleton owns a GWT Panel called the navigation panel . This panel always contains a widget corresponding to the
      fragment ID (the part after the # symbol) in the browser’s location bar. Whenever the fragment ID changes for any reason (for
      example, because the user pressed the back button, navigated to a bookmarked URL, or simply typed a fragment ID by hand), the
      widget in the navigation panel is replaced by the widget associated with that fragment ID. Likewise, when the application asks the
      navigation system to follow a link, the fragment ID in the browser’s location bar is updated to reflect the new current page.
    </p>

    <h3>Declaring a Page</h3>

    <p>Pages in Errai are subclasses of GWT's Widget class. To declare a page, simply annotate any subclass of
       Widget with the
      <code>@Page</code> annotation:</p>

    <h5>ItemPage.java</h5>
    <pre class="code-snippet-small" data-language="java">
      @Page
      public class ItemPage extends Composite {
        // Some code...
      }
    </pre>
    <p>
      By default, the name of a page is the simple name of the class that declares it. In the above example, the
      ItemPage will fill the
      navigation panel whenever the browser’s location bar reads
      <code class="textblock">localhost:8888/errai-forge-demo/index.html<strong>#ItemPage</strong></code>
      If you prefer a different page name, use the @Page annotation’s path attribute:
    </p>
    <h5>ItemPage.java</h5>
    <pre class="code-snippet-small" data-language="java">
      @Page(path="items")
      public class ItemPage extends Composite {
        // Some code...
      }
    </pre>
    <p>Using this in our ErraiDemo example, the URL to the ItemPage would look
       like<code class="textblock">localhost:8888/errai-forge-demo/index.html<strong>#items</strong></code></p>

    <h4>Default Page</h4>

    <p>Every app using Errai Navigation must have exactly one <strong>default page</strong>. This requirement is
       enforced at compile time.
       The default (starting) page is the one that is displayed when there is no fragment ID in the URL bar. In
       addition, in case of any
       page navigation errors, Errai's default error handling behaviour is to navigate back to the default page.
      <br/>
       Use the <code>role = DefaultPage.class</code> attribute to declare the default starting page, like this:
    </p>
    <h5>ItemPage.java</h5>
    <pre class="code-snippet-small" data-language="java">
      @Page(role = DefaultPage.class)
      public class ItemPage extends Composite {
        // Some code...
      }
	</pre>

    <h4>Page Roles</h4>

    <p><code>DefaultPage.class</code> is just one example of a page role. A page role is simply an interface used to
                                      mark @Page types. The main uses for page roles are as follows:</p>
    <ul>
      <li>Using the Navigation singleton, you can look up all pages that have a specific role.</li>
      <li>If a role is unique (as is the case with DefaultPage) then it should extend UniquePageRole. This will allow
          you to use Navigation to navigate to the page by its role.
      </li>
    </ul>

    <h3>Page State Parameters</h3>

    <p>Oftentimes, a page widget is used to represent an instance of a class of things. For example, our ItemPage
    may be used as a template to display a particular user-selected item available at a store. In this case, it is
    important that the bookmarkable navigation URL includes not only the name of the page but also an identifier for
    the particular item being displayed.</p>

    <p>To do this, Errai Navigation uses page state parameters. Consider the following page widget:</p>

    <pre class="code-snippet-small" data-language="java">
      @Page
      public class ItemPage extends VerticalPanel {

        @PageState
        private int itemId;

        // Code ...
      }
    </pre>

    <p>This page would be accessible at a URL like the following: </p>
    <code class="textblock">http://www.company.com/store/index.html<strong>#ItemPage;id=4</strong></code>

    <p>where the host address is <code>www.company.com</code> and the application context is <code>store</code>. Before
       loading up the page, the Navigation singleton would assign <code>itemId = 4</code>.</p>

    <p>Page state parameters can also be accessed using URLs with path parameters. In this case, you have to declare the
    template of the page’s path in the path field of the @Page annotation. As an example, consider the following code:</p>

    <h3>Page Lifecycles</h3>

    <p>There are four annotations related to page lifecycle events: <code>@PageShowing, @PageShown, @PageHiding, and
                                                                          @PageHidden</code>.These annotations designate
       methods so a page widget can be notified when it is displayed or hidden. The actual order of events is
       described in the next section.</p>

    <h5>ItemPage.java</h5>
    <pre class="code-snippet" data-language="java">
      @Page
      public class ItemPage extends VerticalPanel {
        @PageShowing
        private void preparePage() {
        }

        @PageHiding
        private void unpreparePage() {
        }

        // Some code...
    }
    </pre>

    <h4>Lifecycle Phases</h4><!--do we really need this section -->
    <p>Here is the order of execution of lifecycle pages when transitioning from one page to another:</p>

    <ol>
      <li>The fragment identifier in the URL changes.</li>
      <li>The @PageHiding method on the current (about-to-be-navigated-away-from) page is invoked.</li>
      <li>The current page is removed from the browser’s DOM.</li>
      <li>The @PageHidden method on the just-removed page is invoked.</li>
      <li>The navigation system looks up the corresponding new '@Page' bean in the client-side bean manager.</li>
      <li>The navigation system writes to all @PageState fields in the new page bean (more on this in the next
          section).
      </li>
      <li>The @PageShowing method of the new page is invoked.</li>
      <li>The new page widget is added to the DOM (as a direct child of the navigation content panel).</li>
      <li>The @PageShown method of the new page is invoked.</li>
    </ol>


  </div>
</div>
